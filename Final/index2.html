<html>
    <head>
        <title>Chicago's Spatial Mismatch</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"/>
        <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"></script>
        <script src="https://skeate.dev/Leaflet.timeline/examples/leaflet.timeline.js"></script>
        <style>
        html,
        body {
            margin: 0;
            padding: 0;
        }
        #map {
            width: 100vw;
            height: 100vh;
        }
        .leaflet-bottom.leaflet-left {
            width: 100%;
        }
        .leaflet-control-container .leaflet-timeline-controls {
            box-sizing: border-box;
            width: 100%;
            margin: 0;
            margin-bottom: 15px;
        }
        .opacity-control {
            position: absolute;
            bottom: 10px;
            right: 10px;
            padding: 6px 8px;
            font: 14px/16px Arial, Helvetica, sans-serif;
            background: white;
            background: rgba(255, 255, 255, 0.8);
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
            border-radius: 5px;
            width: 200px;
        }
        </style>
        </head>
        <body>
            <div id="map"></div>
            <script>
            var background =
            L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
                maxZoom: 19,
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            });
            
            var map = L.map("map", {
                layers: [background],
                center: new L.LatLng(41.823405912708964, -87.7305608060591),
                zoom: 11,
            });
            
            var DescriptionControl = L.Control.extend({
                options: {
                    position: 'topright'
                },
                onAdd: function (map) {
                    var container = L.DomUtil.create('div', 'leaflet-control-description');
                    container.style.padding = '6px';
                    container.style.backgroundColor = 'rgba(255, 255, 255, 0.8)';
                    container.style.borderRadius = '5px';
                    container.style.boxShadow = '0 0 15px rgba(0, 0, 0, 0.2)';
                    container.style.maxWidth = '300px';
                    container.innerHTML = '<h4>Vulnerability Index</h4><p>The vulnerability index represents a higher degree for the mismatch between transit access and employment, lower values indicate lower vulnerability.</p>';
                    return container;
                }
            });
            
            map.addControl(new DescriptionControl());

            function onLoadData(data) {
                timeline = L.timeline(data, {
                    style: function (data) {
                        return {
                            stroke: false,
                            color: "#404040",
                            fillOpacity: 0.9,
                        };
                    },
                    waitToUpdateMap: true,
                    onEachFeature: function (feature, layer) {
                        layer.bindTooltip('<h3>'+ feature.properties.Data_name10 + '</h3> <p>' + ' <br>Unemployment Rate: <strong>' +
                            feature.properties.Data_DP03 + '</strong> <br>Share of Public Transit Commuters: <strong>' + feature.properties.Data_DP_01 + '</strong></p>');
                        },
                    });
                    var timelineControl = L.timelineSliderControl({
                        formatOutput: function (timestamp) {
                            var date = new Date(timestamp);
                            return date.toLocaleDateString();
                        },
                        enableKeyboardControls: true,
                    });
                    timeline.addTo(map);
                    timelineControl.addTo(map);
                    timelineControl.addTimelines(timeline);
                }
            </script>
            <script src="https://Ldepablo11.github.io/Final/Mismatch.jsonp"></script>
        </body>
</html>
